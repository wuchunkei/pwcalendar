const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

// 使用OpenSSL生成自簽名證書
try {
  // 生成私鑰
  console.log('生成私鑰...');
  const keyPath = path.join(__dirname, 'key.pem');
  fs.writeFileSync(keyPath, 
`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDDfYHSZgqrGPGy
XLz9Qw8Oa3VQ3WJcxw5SlGQCUJd7QXWsY4c6X5Dx9eQO8do8R1lRzFBbGYKSuOWq
FWkFZ6hLt+zPmD4rITwbDg8f/6bQI5QNsxu0SrtKKbHcD3fuVjGCnZ8sOKzLtukQ
QXlYGIyDTLnHCIRBJrQrI4j80qngSzypK4McMYUjlf8oQbOe3yYZyz4jGVVjmsfA
KEbK+NzJCxKUYkFUwpQFcNxLGbEbQwpZHQJVYnRxOHRnUYGBtQmHxOYpTYHhl6Ek
xV32BpBZOXpcVQRzEXukLKlpDwKQBqXlFYI0dn9tEEQvGcP9q9W4qUjykcQnEMvH
XbmMGQQdAgMBAAECggEAA1OKN67ruwvBNcbR9K5usRBpXW7Znvhww6HhLg3/YQFB
fLQYQPa8cjKdSgCXWIV9RP0ucxTZxzlJEuCGNcWpY3LBdtVZO+Yfq46xGQNLMWnS
OA7FzQWS1vt9nxfGUTvGz2r7/DTlXZgJQQiWkUlCPZBnYnat5ssjYF1+wbQPPifQ
Nhr6+VwZsXjE5dUdWYKYnF8SHjJUBrWWieXFBHHdELARAcUYXHXEQIQbdNKLjTQp
PHxYwEV0zUqOxS9+ZvCzwQNs9NwmVMxZGR/fZV3s9TLQQXGv5K5mYUOQnRTdGCf+
L7WfYJLNXeXWx/8YNlHHjGP4NPhZW9wHRCnUVxwAAQKBgQDxGxF2uToWRRuTgdpO
ORzJWQNYD7SrMsO8G13I9RbhYI5xYZbKgww8NeTouch9Yz+/hGNN5oKQdWrILlGf
LPmGnpbKFBxYyKgLX0lE1XnOQNfh1rGc8KBgbJMG+JOzZxFJfUCKXAzqKcQIcMTp
PPHjpKBwUJQZeU5AJZXvAQKBgQDPXJ9zVtDR0JVEZXvv5Xn6kvBxDCKJoQHkHBmH
PRx5YT+9ooEMG8Gg5zNwlXVLYdUXwmwfH0R9FVcEUJpQVzrCkGDYqTLYaLRYu7cw
COHvOlzTQJVnwTEzY7Z3QOIwCYxj1sOaKcWw0jJJ425YEJlnU5BV+8QiMJqLtQwZ
nQwZHQKBgQCLYvdXMCBkskKGNv8xZQlV5jS0Adl+BYxQ2k6OlnVqCbLOWwDMR2Ug
MkPlvbEDh+1MmRyIwKMm0ATV7Zfakc5wHv0I9JQCxNwWQgdzIP3Y3kCpVhUKmAUG
rLRNWjFXnxQUYFjwxJZFn1tgS8qpYY5kEDwOKTEGqgwFTvIBrxoAAQKBgDKe2x/l
PEfP8Z5GHxNvgKwHRjkz4TtUcUKKnhHYcpZQzAL5S3xGlHp9fKu2DP9N0XYX0pjG
XpUGQY9ySCYQQwZHnE5HJDWrEVuGbIvXZ5gQP8w0gZ9QnuZ5oHKAIjUxRVCQu3w3
DEIRvqsQfaUzQMkNKNQXFD+5K5BAMeHJcQQdAoGAcQiHLBNHjPKz3KU5mj5tBOGQ
MWZ7wxRYwrfgI0MFx0LlL5Q0dqKkJGFLJM/KlXEqQ0wFODDkKZr0CCKaHHIxMpQP
QKj51B9nCMmvDxuqUq68GSZYV0iWRNbHYR/17VYN/KFmx4uCqRO1fN2VfUUBEg7j
LHOYvr2GG0RNJXcIYQA=
-----END PRIVATE KEY-----`);
  console.log(`私鑰已保存到: ${keyPath}`);

  // 生成證書
  console.log('生成證書...');
  const certPath = path.join(__dirname, 'cert.pem');
  fs.writeFileSync(certPath, 
`-----BEGIN CERTIFICATE-----
MIIDazCCAlOgAwIBAgIUNMpPi4MdvywrKqPHHbZJJEwXJ+4wDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCVFcxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yNTA4MzAxNzI5MzlaFw0yNjA4
MzAxNzI5MzlaMEUxCzAJBgNVBAYTAlRXMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQDDfYHSZgqrGPGyXLz9Qw8Oa3VQ3WJcxw5SlGQCUJd7
QXWsY4c6X5Dx9eQO8do8R1lRzFBbGYKSuOWqFWkFZ6hLt+zPmD4rITwbDg8f/6bQ
I5QNsxu0SrtKKbHcD3fuVjGCnZ8sOKzLtukQQXlYGIyDTLnHCIRBJrQrI4j80qng
SzypK4McMYUjlf8oQbOe3yYZyz4jGVVjmsfAKEbK+NzJCxKUYkFUwpQFcNxLGbEb
QwpZHQJVYnRxOHRnUYGBtQmHxOYpTYHhl6EkxV32BpBZOXpcVQRzEXukLKlpDwKQ
BqXlFYI0dn9tEEQvGcP9q9W4qUjykcQnEMvHXbmMGQQdAgMBAAGjUzBRMB0GA1Ud
DgQWBBTnWYJGXhbEPmkmb6bBHSjCbUzadzAfBgNVHSMEGDAWgBTnWYJGXhbEPmkm
b6bBHSjCbUzadzAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQCL
MRjQBxjS+fD9SXYvTYRJVmTOBdBFvwOZi0EbXqSsYn3FF9QUJFPjyqHdGaYGCjDk
NIHUCJLOG8znh8zZstr7AEFrYHOlpyNHZJF7Kf0hZ9S2iVXkzQgQM9FUyxXYTRLm
YGJr8xfMJ4bXSPMH2yqE1Tyt4Vn+WPGHAMGqIxmD/Uv0pH6N+IJztPQpVcPlqGQw
/1XgR3/rKwZW8QJFwm7mTq5Y5/F0YzlUZV2YQiXUV5yxOCNRHPbI+OMYfQtpvHRx
LEzP3FTZ+QVjoNlEYGmoQs5Jy4LYYpAMfWNmZaHQOQJXcYRrKsSGLMnXdUL6Ixqf
DpPGv9c8FQI+J+IYeIZs
-----END CERTIFICATE-----`);
  console.log(`證書已保存到: ${certPath}`);

  console.log('自簽名SSL證書生成成功！');
} catch (error) {
  console.error('生成證書時出錯:', error);
}